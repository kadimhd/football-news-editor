<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ูุญุฑุฑ ุฃุฎุจุงุฑ ูุฑุฉ ุงููุฏู</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4 bg-light">
  <div class="container">
    <h3 class="mb-4">๐ฐ ูุญุฑุฑ ุฃุฎุจุงุฑ ูุฑุฉ ุงููุฏู</h3>

    <div class="mb-3">
      <label class="form-label">ุงูููู</label>
      <select id="daySelect" class="form-select">
        <option value="today">ุงูููู</option>
        <option value="yesterday">ุงูุฃูุณ</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">ุงุฎุชุฑ ุงูุฏูุฑู</label>
      <select id="leagueSelect" class="form-select">
        <!-- ูุงุฆูุฉ ุซุงุจุชุฉ -->
        <option value="39">ุงูุฏูุฑู ุงูุฅูุฌููุฒู ุงูููุชุงุฒ</option>
        <option value="140">ุงูุฏูุฑู ุงูุฅุณุจุงูู</option>
        <option value="135">ุงูุฏูุฑู ุงูุฅูุทุงูู</option>
        <option value="78">ุงูุฏูุฑู ุงูุฃููุงูู</option>
        <option value="61">ุงูุฏูุฑู ุงููุฑูุณู</option>
        <option value="2">ุฏูุฑู ุฃุจุทุงู ุฃูุฑูุจุง</option>
        <option value="3">ุงูุฏูุฑู ุงูุฃูุฑูุจู</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">ุงุฎุชุฑ ุงููุจุงุฑุงุฉ</label>
      <select id="matchSelect" class="form-select"></select>
    </div>

    <div class="mb-3">
      <label class="form-label">ููุชุงุญ API (RapidAPI)</label>
      <input id="apiKey" class="form-control" type="password" placeholder="ุถุน ุงูููุชุงุญ ููุง">
    </div>

    <button class="btn btn-primary" onclick="loadMatches()">๐ ุชุญููู ุงููุจุงุฑูุงุช</button>
    <button class="btn btn-success" onclick="generateNews()">โ๏ธ ุชูููุฏ ุงูุฎุจุฑ</button>

    <div class="mt-4">
      <label class="form-label">ุงููุต ุงูุฅุฎุจุงุฑู</label>
      <textarea id="newsOutput" class="form-control" rows="10"></textarea>
    </div>
  </div>

<script>
const API_HOST = "https://v3.football.api-sports.io";

async function loadMatches() {
  const key = document.getElementById("apiKey").value.trim();
  const leagueId = document.getElementById("leagueSelect").value;
  const day = document.getElementById("daySelect").value;
  let date = new Date();
  if (day === "yesterday") date.setDate(date.getDate()-1);
  let formattedDate = date.toISOString().split("T")[0];

  const res = await fetch(`${API_HOST}/fixtures?league=${leagueId}&date=${formattedDate}`, {
    headers: { "x-rapidapi-key": key }
  });
  const data = await res.json();
  const matches = data.response;
  const matchSelect = document.getElementById("matchSelect");
  matchSelect.innerHTML = "";
  matches.forEach(m => {
    let opt = document.createElement("option");
    opt.value = m.fixture.id;
    opt.innerText = `${m.teams.home.name} ุถุฏ ${m.teams.away.name} (${m.goals.home ?? 0}:${m.goals.away ?? 0})`;
    matchSelect.appendChild(opt);
  });
}

async function generateNews() {
  const key = document.getElementById("apiKey").value.trim();
  const matchId = document.getElementById("matchSelect").value;
  const res = await fetch(`${API_HOST}/fixtures?id=${matchId}`, {
    headers: { "x-rapidapi-key": key }
  });
  const data = await res.json();
  const match = data.response[0];

  let home = match.teams.home.name;
  let away = match.teams.away.name;
  let score = `${match.goals.home} - ${match.goals.away}`;
  let league = match.league.name;
  let round = match.league.round;

  let goals = match.events?.filter(e => e.type === "Goal")
    .map(e => `${e.player.name} (${e.team.name}) ูู ุงูุฏูููุฉ ${e.time.elapsed}`)
    .join(" / ") || "";

  let reds = match.events?.filter(e => e.detail === "Red Card")
    .map(e => `${e.player.name} (${e.team.name})`)
    .join("ุ ") || "";

  let template = `
${home} ู${away} ุงูุชููุง ุถูู ${league} (${round})ุ ูุงูุชูุช ุงูููุงุฌูุฉ ุจูุชูุฌุฉ ${score}.
${goals ? "ุฃูุฏุงู ุงููุจุงุฑุงุฉ: " + goals + "." : ""}
${reds ? "ุงูุจุทุงูุงุช ุงูุญูุฑุงุก: " + reds + "." : ""}
  `;

  document.getElementById("newsOutput").value = template;
}
</script>
</body>
</html>
